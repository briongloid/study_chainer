https://github.com/chainer/chainer/blob/master/examples/mnist/train_mnist.py